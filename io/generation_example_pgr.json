{
  "generation": {
    "general": {
      "id": "genration_bduni_pgr",
      "logs": {
        "configFile": "sample_log_config.json"
      },
      "parallelization": {
        "threads": 4
      },
      "overwrite": true,
      "operation": "creation"
    },
    "bases": [
      {
        "id": "base_bduni",
        "type": "bdd",
        "configFile": "sample_db_config.json"
      }
    ],
    "workingSpace": {
      "directory": "/var/tmp/",
      "baseId": "base_bduni"
    },
    "resource": {
      "ressourceId": "bduni_j+1",
      "type": "pgr",
      "description": "Données BDUNI v2 mise à jour quotidiennement.",
      "boundingBox": "0,6000000,1300000,7200000",
      "defaultProjection": "EPSG:2154",
      "availableProjection": [
        "EPSG:2154"
      ],
      "topology": {
        "description": "Données issues de la BDUNI de l'IGN.",
        "storage": {
          "baseId": "base_bduni",
          "dbConfig": "sample_db_config.json"
        },
        "projection": "EPSG:2154",
        "mapping": {
          "source": {
            "baseId": "base_bduni"
          },
          "storage": {
            "file": "sql/bduni_convert.sql"
          }
        },
        "defaultAttributs": [
          "name"
        ]
      },
      "costs": [
        {
          "profile": "car",
          "optmization": "fastest",
          "compute": {
            "storage": {
              "file": "sql/car-fastest.sql"
            }
          }
        },
        {
          "profile": "car",
          "optmization": "shortest",
          "compute": {
            "storage": {
              "file": "sql/car-shortest.sql"
            }
          }
        },
        {
          "profile": "bike",
          "optmization": "fastest",
          "compute": {
            "storage": {
              "file": "sql/bike-fastest.sql"
            }
          }
        },
        {
          "profile": "bike",
          "optmization": "shortest",
          "compute": {
            "storage": {
              "file": "sql/bike-shortest.sql"
            }
          }
        }
      ],
      "operations": [
        {
          "type": "route",
          "rate": 10,
          "maxIntermediatePoints": 5,
          "maxNumberOfConstraints": 2,
          "constraints": [
            {
              "id": "filter-1",
              "type": "constraint-pgr-enum",
              "description": "Type d'arc emprunté.",
              "key": "road_type",
              "values": "",
              "availableConstraintType": [
                "banned",
                "preferred",
                "unpreferred"
              ],
              "availableOperators": [
                "=",
                "!=",
                "like"
              ],
              "propertiesColumn": "type"
            },
            {
              "id": "filter-2",
              "type": "constraint-pgr-number",
              "description": "Pente des arcs empruntés.",
              "key": "road_slope",
              "values": "",
              "availableConstraintType": [
                "banned",
                "preferred",
                "unpreferred"
              ],
              "availableOperators": [
                "=",
                "!=",
                "<",
                ">",
                "<=",
                ">="
              ],
              "propertiesColumn": "slope"
            },
            {
              "id": "filter-3",
              "type": "constraint-pgr-string",
              "description": "Nom des arcs empruntés.",
              "key": "road_name",
              "values": "string",
              "availableConstraintType": [
                "banned",
                "preferred",
                "unpreferred"
              ],
              "availableOperators": [
                "=",
                "!=",
                "like"
              ],
              "propertiesColumn": "name"
            }
          ],
          "defaultParameters": [
            {
              "id": "format",
              "default": "application/json"
            },
            {
              "id": "getSteps",
              "default": true
            },
            {
              "id": "getBbox",
              "default": true
            },
            {
              "id": "getInstructions",
              "default": false
            },
            {
              "id": "distanceUnit",
              "default": "kilometer"
            },
            {
              "id": "timeUnit",
              "default": "h-m-s"
            }
          ]
        },
        {
          "type": "nearest",
          "rate": 20,
          "maxNumber": 100,
          "defaultParameters": [
            {
              "id": "format",
              "default": "application/json"
            },
            {
              "id": "getId",
              "default": false
            },
            {
              "id": "number",
              "default": 1
            },
            {
              "id": "type",
              "default": "all"
            }
          ]
        },
        {
          "type": "isochrone",
          "rate": 10,
          "costs": [
            {
              "key": "temps",
              "description": "Calculer des isochrones.",
              "sourceIds": [
                "bduni-car-fastest",
                "bduni-bike-fastest"
              ],
              "unit": "minute",
              "min": 1,
              "max": 600
            },
            {
              "key": "distance",
              "description": "Calculer des iso-distances.",
              "sourceIds": [
                "bduni-car-shortest",
                "bduni-bike-shortest"
              ],
              "unit": "kilometer",
              "min": 1,
              "max": 1000
            }
          ],
          "constraints": [
            {
              "id": "filter-isochrone",
              "type": "constraint-pgr-isochrone",
              "description": "Type d'arc emprunté.",
              "key": "road_type",
              "values": "",
              "propertiesColumn": "type",
              "availableConstraintType": [
                "banned"
              ],
              "availableOperators": [
                "="
              ]
            }
          ],
          "defaultParameters": [
            {
              "id": "costType",
              "default": "temps"
            },
            {
              "id": "profile",
              "default": "car"
            },
            {
              "id": "direction",
              "default": "départ"
            },
            {
              "id": "format",
              "default": "application/json"
            },
            {
              "id": "distanceUnit",
              "default": "kilometer"
            },
            {
              "id": "timeUnit",
              "default": "h-m-s"
            }
          ]
        }
      ],
      "outputs": {
        "configuration": {
          "storage": {
            "file": "ressource_example_pgr.yaml"
          }
        },
        "graphs": {
          "storage": {
            "baseId": "base_bduni"
          },
          "dirs": {
            "dbConfigDir": "",
            "sqlDir": "",
            "profileDir": "",
            "resourceDir": ""
          },
          "sshConfig":{
            "host": "127.0.0.1",
            "port": 22,
            "username": "toto",
            "password": "mdp1"
          }
        }
      }
    }
  }
}
